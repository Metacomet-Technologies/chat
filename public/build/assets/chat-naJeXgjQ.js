import{a as b,r as i,j as e,b as Y,g as J,c as C,H as Q}from"./app-BZWECUWP.js";import{c as g,B as v,u as S,a as A}from"./app-logo-icon-D-HGr3tP.js";import{c as G,u as Z,R as ee,I as se,a as te,A as ae}from"./app-layout-B9byoX6T.js";import{I as L,L as N}from"./label-BKTSVS1F.js";import{D as re,a as oe,b as ne,c as ie,d as ce,e as le,f as de}from"./dialog-CgsszsvH.js";import{u as ue,c as $,a as z,P as xe,b as me}from"./index-NBLH4Rug.js";import{P as k}from"./index-DvGXFfmZ.js";import{u as pe}from"./index-B-zRLaSI.js";/* empty css            *//**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],fe=g("arrow-left",he);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ge=g("circle",ve);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],ye=g("hash",je);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Ne=g("lock",be);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],I=g("plus",Re);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],we=g("send",ke);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ze=g("users",Ce),R={get:t=>b.get(t),post:(t,a)=>b.post(t,a),put:(t,a)=>b.put(t,a),delete:t=>b.delete(t)};function Se({onSendMessage:t,isMobile:a=!1}){const[r,o]=i.useState(""),[s,c]=i.useState(!1),l=async()=>{r.trim()&&!s&&(c(!0),await t(r.trim()),o(""),c(!1))},x=d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),l())};return e.jsx("div",{className:`border-t border-zinc-200 dark:border-zinc-700 ${a?"p-3":"p-4"}`,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(L,{type:"text",value:r,onChange:d=>o(d.target.value),onKeyPress:x,placeholder:"Type a message...",className:`flex-1 ${a?"text-base":""}`,disabled:s,autoComplete:"off",autoCorrect:"on",autoCapitalize:"sentences"}),e.jsx(v,{onClick:l,disabled:!r.trim()||s,size:a?"icon":"default",className:a?"h-10 w-10":"",children:e.jsx(we,{className:a?"h-5 w-5":"h-4 w-4"})})]})})}function _e({messages:t,currentUserId:a,isMobile:r=!1}){return e.jsx("div",{className:"space-y-4",children:t.map(o=>{const s=o.userId===a;return e.jsx("div",{className:`flex ${s?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`${r?"max-w-[85%]":"max-w-xs lg:max-w-md"} rounded-lg ${r?"px-3 py-2":"px-4 py-2"} ${s?"bg-blue-500 text-white":"bg-zinc-200 text-zinc-900 dark:bg-zinc-700 dark:text-white"}`,children:[!s&&o.user&&e.jsx("div",{className:`mb-1 ${r?"text-[11px]":"text-xs"} font-semibold opacity-75`,children:o.user.name}),e.jsx("div",{className:`break-words ${r?"text-sm":""}`,children:o.content}),e.jsx("div",{className:`mt-1 ${r?"text-[10px]":"text-xs"} ${s?"text-blue-100":"text-zinc-500 dark:text-zinc-400"}`,children:new Date(o.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},o.id)})})}function P({room:t,isMobile:a=!1}){const[r,o]=i.useState([]),[s,c]=i.useState(!1),l=i.useRef(null),{auth:x}=Y().props;J(`room.${t.id}`,".message.sent",n=>{o(u=>u.some(f=>f.id===n.message.id)?u:[...u,n.message])},[t.id],"private"),i.useEffect(()=>{o([]),m()},[t.id]),i.useEffect(()=>{d()},[r]);const d=()=>{l.current?.scrollIntoView({behavior:"smooth"})},m=async()=>{c(!0);try{const n=await R.get(route("api.rooms.messages.index",{room:t.id}));o(n.data.messages.reverse())}catch(n){console.error("Failed to fetch messages:",n)}finally{c(!1)}},p=async n=>{try{await R.post(route("api.rooms.messages.store",{room:t.id}),{content:n})}catch(u){console.error("Failed to send message:",u)}};return e.jsxs("div",{className:"flex h-full flex-col",children:[!a&&e.jsxs("div",{className:"border-b border-zinc-200 p-4 dark:border-zinc-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-zinc-900 dark:text-white",children:t.name}),t.users&&e.jsxs("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:[t.users.length," members"]})]}),e.jsx("div",{className:`flex-1 overflow-y-auto ${a?"p-3":"p-4"}`,children:s?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("div",{className:"text-zinc-500 dark:text-zinc-400",children:"Loading messages..."})}):e.jsxs(e.Fragment,{children:[e.jsx(_e,{messages:r,currentUserId:x.user.id,isMobile:a}),e.jsx("div",{ref:l})]})}),e.jsx(Se,{onSendMessage:p,isMobile:a})]})}var _="Radio",[Ie,M]=$(_),[Pe,Ee]=Ie(_),F=i.forwardRef((t,a)=>{const{__scopeRadio:r,name:o,checked:s=!1,required:c,disabled:l,value:x="on",onCheck:d,form:m,...p}=t,[n,u]=i.useState(null),h=S(a,y=>u(y)),f=i.useRef(!1),j=n?m||!!n.closest("form"):!0;return e.jsxs(Pe,{scope:r,checked:s,disabled:l,children:[e.jsx(k.button,{type:"button",role:"radio","aria-checked":s,"data-state":V(s),"data-disabled":l?"":void 0,disabled:l,value:x,...p,ref:h,onClick:z(t.onClick,y=>{s||d?.(),j&&(f.current=y.isPropagationStopped(),f.current||y.stopPropagation())})}),j&&e.jsx(B,{control:n,bubbles:!f.current,name:o,value:x,checked:s,required:c,disabled:l,form:m,style:{transform:"translateX(-100%)"}})]})});F.displayName=_;var T="RadioIndicator",O=i.forwardRef((t,a)=>{const{__scopeRadio:r,forceMount:o,...s}=t,c=Ee(T,r);return e.jsx(xe,{present:o||c.checked,children:e.jsx(k.span,{"data-state":V(c.checked),"data-disabled":c.disabled?"":void 0,...s,ref:a})})});O.displayName=T;var De="RadioBubbleInput",B=i.forwardRef(({__scopeRadio:t,control:a,checked:r,bubbles:o=!0,...s},c)=>{const l=i.useRef(null),x=S(l,c),d=pe(r),m=me(a);return i.useEffect(()=>{const p=l.current;if(!p)return;const n=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(n,"checked").set;if(d!==r&&h){const f=new Event("click",{bubbles:o});h.call(p,r),p.dispatchEvent(f)}},[d,r,o]),e.jsx(k.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:x,style:{...s.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});B.displayName=De;function V(t){return t?"checked":"unchecked"}var Ae=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],w="RadioGroup",[Ge,es]=$(w,[G,M]),H=G(),K=M(),[Le,$e]=Ge(w),q=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,name:o,defaultValue:s,value:c,required:l=!1,disabled:x=!1,orientation:d,dir:m,loop:p=!0,onValueChange:n,...u}=t,h=H(r),f=Z(m),[j,y]=ue({prop:c,defaultProp:s??null,onChange:n,caller:w});return e.jsx(Le,{scope:r,name:o,required:l,disabled:x,value:j,onValueChange:y,children:e.jsx(ee,{asChild:!0,...h,orientation:d,dir:f,loop:p,children:e.jsx(k.div,{role:"radiogroup","aria-required":l,"aria-orientation":d,"data-disabled":x?"":void 0,dir:f,...u,ref:a})})})});q.displayName=w;var U="RadioGroupItem",W=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,disabled:o,...s}=t,c=$e(U,r),l=c.disabled||o,x=H(r),d=K(r),m=i.useRef(null),p=S(a,m),n=c.value===s.value,u=i.useRef(!1);return i.useEffect(()=>{const h=j=>{Ae.includes(j.key)&&(u.current=!0)},f=()=>u.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",f),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",f)}},[]),e.jsx(se,{asChild:!0,...x,focusable:!l,active:n,children:e.jsx(F,{disabled:l,required:c.required,checked:n,...d,...s,name:c.name,ref:p,onCheck:()=>c.onValueChange(s.value),onKeyDown:z(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:z(s.onFocus,()=>{u.current&&m.current?.click()})})})});W.displayName=U;var Me="RadioGroupIndicator",X=i.forwardRef((t,a)=>{const{__scopeRadioGroup:r,...o}=t,s=K(r);return e.jsx(O,{...s,...o,ref:a})});X.displayName=Me;var Fe=q,Te=W,Oe=X;function Be({className:t,...a}){return e.jsx(Fe,{"data-slot":"radio-group",className:A("grid gap-3",t),...a})}function E({className:t,...a}){return e.jsx(Te,{"data-slot":"radio-group-item",className:A("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(Oe,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(ge,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}function Ve({onCreate:t,compact:a=!1}){const[r,o]=i.useState(!1),[s,c]=i.useState(""),[l,x]=i.useState("public"),[d,m]=i.useState(!1),p=async()=>{s.trim()&&(m(!0),await t(s.trim(),l),c(""),x("public"),o(!1),m(!1))};return e.jsxs(re,{open:r,onOpenChange:o,children:[e.jsx(oe,{asChild:!0,children:a?e.jsx(v,{variant:"ghost",size:"icon",title:"Create new chat room",children:e.jsx(I,{className:"h-4 w-4"})}):e.jsxs(v,{variant:"outline",className:"w-full",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"New Chat Room"]})}),e.jsxs(ne,{className:"sm:max-w-[425px]",children:[e.jsxs(ie,{children:[e.jsx(ce,{children:"Create New Chat Room"}),e.jsx(le,{children:"Create a new chat room to start conversations with other users."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"name",children:"Room Name"}),e.jsx(L,{id:"name",value:s,onChange:n=>c(n.target.value),placeholder:"e.g., General Discussion",className:"w-full"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{children:"Room Type"}),e.jsxs(Be,{value:l,onValueChange:n=>x(n),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{value:"public",id:"public"}),e.jsx(N,{htmlFor:"public",className:"font-normal",children:"Public - Anyone can join"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{value:"private",id:"private"}),e.jsx(N,{htmlFor:"private",className:"font-normal",children:"Private - Invite only"})]})]})]})]}),e.jsxs(de,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>o(!1),disabled:d,children:"Cancel"}),e.jsx(v,{type:"submit",onClick:p,disabled:!s.trim()||d,children:d?"Creating...":"Create Room"})]})]})]})}function D({rooms:t,selectedRoom:a,onRoomSelect:r,onRoomCreate:o}){return e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-zinc-200 p-4 dark:border-zinc-700",children:[e.jsx("h2",{className:"text-lg font-semibold text-zinc-900 dark:text-white",children:"Chat Rooms"}),e.jsx(Ve,{onCreate:o,compact:!0})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:t.length===0?e.jsx("div",{className:"p-4 text-center text-sm text-zinc-500 dark:text-zinc-400",children:"No chat rooms yet. Create one to get started!"}):t.map(s=>e.jsxs("button",{onClick:()=>r(s),className:`w-full p-4 text-left transition-colors hover:bg-zinc-100 active:bg-zinc-200 dark:hover:bg-zinc-800 dark:active:bg-zinc-700 ${a?.id===s.id?"border-l-4 border-blue-500 bg-zinc-100 dark:bg-zinc-800":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.isPrivate?e.jsx(Ne,{className:"h-4 w-4 text-zinc-500 dark:text-zinc-400"}):e.jsx(ye,{className:"h-4 w-4 text-zinc-500 dark:text-zinc-400"}),e.jsx("span",{className:"font-medium text-zinc-900 dark:text-white",children:s.name})]}),e.jsxs("div",{className:"mt-1 flex items-center gap-4 text-xs text-zinc-500 dark:text-zinc-400",children:[s.users&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ze,{className:"h-3 w-3"}),s.users.length]}),s.lastMessageAt&&e.jsx("span",{children:new Date(s.lastMessageAt).toLocaleTimeString()})]})]},s.id))})]})}function He({initialRooms:t=[],selectedRoomId:a}){const[r,o]=i.useState(t),[s,c]=i.useState(null),l=te();i.useEffect(()=>{x()},[]),i.useEffect(()=>{if(a&&r.length>0){const n=r.find(u=>u.id===a);n&&c(n)}},[a,r]);const x=async()=>{try{const n=await R.get(route("api.rooms.index"));o(n.data)}catch(n){console.error("Failed to fetch rooms:",n)}},d=n=>{C.visit(route("chat.room",{room:n.id}),{preserveState:!0,preserveScroll:!0})},m=async(n,u)=>{try{const f=(await R.post(route("api.rooms.store"),{name:n,type:u,isPrivate:u==="private"})).data;console.log("Room created:",f),C.visit(route("chat.room",{room:f.id}))}catch(h){console.error("Failed to create room:",h)}},p=()=>{C.visit(route("chat"),{preserveState:!0})};return l?e.jsx("div",{className:"h-full bg-zinc-50 dark:bg-zinc-900",children:s?e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex items-center border-b border-zinc-200 bg-white px-4 py-3 dark:border-zinc-700 dark:bg-zinc-800",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:p,className:"mr-3",children:e.jsx(fe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-zinc-900 dark:text-white",children:s.name}),s.users&&e.jsxs("p",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:[s.users.length," members"]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(P,{room:s,isMobile:!0})})]}):e.jsx(D,{rooms:r,selectedRoom:s,onRoomSelect:d,onRoomCreate:m})}):e.jsxs("div",{className:"flex h-full bg-zinc-50 dark:bg-zinc-900",children:[e.jsx("div",{className:"hidden w-80 border-r border-zinc-200 lg:block dark:border-zinc-700",children:e.jsx(D,{rooms:r,selectedRoom:s,onRoomSelect:d,onRoomCreate:m})}),e.jsx("div",{className:"flex-1",children:s?e.jsx(P,{room:s}):e.jsx("div",{className:"flex h-full items-center justify-center p-4 text-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg text-zinc-500 dark:text-zinc-400",children:"Select a room to start chatting"}),e.jsx("div",{className:"mt-2 lg:hidden",children:e.jsx(v,{onClick:p,variant:"outline",children:"View Rooms"})})]})})})]})}function ss({rooms:t,selectedRoomId:a}){return e.jsxs(ae,{children:[e.jsx(Q,{title:"Chat"}),e.jsx("div",{className:"h-[calc(100vh-4rem)] lg:h-[calc(100vh-4rem)]",children:e.jsx(He,{initialRooms:t,selectedRoomId:a})})]})}export{ss as default};
